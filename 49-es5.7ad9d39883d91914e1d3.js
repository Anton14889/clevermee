function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{Nns5:function(t,e,i){"use strict";i.r(e),i.d(e,"LinkVerticalComponent",(function(){return m})),i.d(e,"LinkVerticalModule",(function(){return f}));var n=i("ofXK"),s=i("3Pt+"),o=i("fXoL"),r=i("XCOF"),a=["wrapper"],c=["canvas"];function l(t,e){if(1&t){var i=o.Xb();o.Wb(0,"div",11),o.Dc(1),o.Wb(2,"div",12),o.ec("click",(function(t){o.vc(i);var n=e.$implicit,s=o.hc(4);return[s.getEndPosition(t.target,n.order),s.getStartPosition(t.target,n.order)]}))("touchstart",(function(t){o.vc(i);var n=e.$implicit;return o.hc(4).getStartPosition(t.target,n.order)})),o.Vb(),o.Vb()}if(2&t){var n=e.$implicit;o.Gb("one_item",n.isOneInTwoRow),o.Cb(1),o.Fc(" ",n.value," "),o.Cb(1),o.Db("data-order",n.order)}}function u(t,e){if(1&t&&(o.Wb(0,"div",9),o.Cc(1,l,3,4,"div",10),o.Vb()),2&t){var i=o.hc().$implicit;o.Cb(1),o.kc("ngForOf",i)}}function h(t,e){if(1&t&&(o.Ub(0),o.Cc(1,u,2,1,"div",8),o.Tb()),2&t){var i=e.$implicit;o.Cb(1),o.kc("ngIf",i.length)}}function v(t,e){if(1&t){var i=o.Xb();o.Wb(0,"div",13),o.Dc(1),o.Wb(2,"div",14),o.ec("click",(function(t){o.vc(i);var n=e.$implicit,s=o.hc(2);return[s.getEndPosition(t.target,n.order),s.getStartPosition(t.target,n.order)]}))("touchstart",(function(t){o.vc(i);var n=e.$implicit;return o.hc(2).getStartPosition(t.target,n.order)})),o.Vb(),o.Vb()}if(2&t){var n=e.$implicit;o.Cb(1),o.Fc(" ",n.value," "),o.Cb(1),o.Db("data-order",n.order)}}function p(t,e){if(1&t){var i=o.Xb();o.Wb(0,"div",1,2),o.ec("mousemove",(function(t){return o.vc(i),o.hc().lineMove(t)}))("touchmove",(function(t){return o.vc(i),o.hc().lineMove(t)}))("touchend",(function(t){return o.vc(i),o.hc().getTouchPositionB(t)}))("click",(function(t){return o.vc(i),o.hc().clearOnClick(t.target)})),o.Cc(2,h,2,1,"ng-container",3),o.Wb(3,"div",4),o.Cc(4,v,3,2,"div",5),o.Vb(),o.Rb(5,"canvas",6,7),o.Vb()}if(2&t){var n=o.hc();o.Gb("blockAfterGetResults",n.isCorrectValues),o.Cb(2),o.kc("ngForOf",n.resultTopValues),o.Cb(2),o.kc("ngForOf",n.resultBottomValues)}}var m=function(){var t=function(){function t(e){_classCallCheck(this,t),this.exerciseDataService=e,this.position={x1:null,y1:null,x2:null,y2:null},this.results={},this.saveLines={},this.isLineStart=!1,this.startFrom=""}return _createClass(t,[{key:"ngOnChanges",value:function(){var t=this;if(this.list.sort((function(t,e){return t.Order-e.Order})),this.isCorrectValues){this.saveLines={};var e=document.getElementsByClassName("js-top-start-point"),i=document.getElementsByClassName("js-bottom-start-point");return this.list.forEach((function(n,s){var o,r;t.resultTopValues.forEach((function(s){s.forEach((function(s){t.resultBottomValues.forEach((function(t,a){s.order===n.Order&&t.value===n.CorrectValue&&(o=e[n.Order-1],r=i[a])}))}))})),t.saveLines[s]={isCorrect:null,x1:null,y1:null,x2:null,y2:null},t.saveLines[s].isCorrect=n.IsCorrect,t.saveLines[s].x1=t.getCenterPosition(o).x,t.saveLines[s].y1=t.getCenterPosition(o).y,t.saveLines[s].x2=t.getCenterPosition(r).x,t.saveLines[s].y2=t.getCenterPosition(r).y})),this.clearCanvas(),void this.paintSaveLines()}var n=[],s=[];this.list.forEach((function(t){var e={order:t.Order,value:t.Value,isOneInTwoRow:null};"BottomValue"===t.Metric&&n.push(e),"TopValue"===t.Metric&&s.push(e)}));var o=[[],[]];s.forEach((function(t,e){e<3?o[0].push(t):o[1].push(t)})),1===o[1].length&&(o[1][0].isOneInTwoRow=!0),this.resultTopValues=o,this.resultBottomValues=n}},{key:"lineMove",value:function(t){if(this.isLineStart){var e=this.wrapper.nativeElement.getBoundingClientRect().left,i=this.wrapper.nativeElement.getBoundingClientRect().top,n=this.getEventPosition(t).clientX-e,s=this.getEventPosition(t).clientY-i,o=this.position.x1-e,r=this.position.y1-i,a=this.canvas.nativeElement.getContext("2d");this.clearCanvas(),a.beginPath(),a.moveTo(o,r),a.lineTo(n,s),a.stroke(),this.paintSaveLines()}}},{key:"getPositionA",value:function(t,e){this.elemAttention(t),this.position.x1=this.getCenterPosition(t).x,this.position.y1=this.getCenterPosition(t).y,this.isLineStart=!0,this.saveStartNumber=e}},{key:"getStartPosition",value:function(t,e){t.classList.contains("js-top-start-point")&&!this.startFromTop&&(this.startFrom="js-top-start-point",this.startFromTop=!0,this.startFromBottom=!1,this.getPositionA(t,e)),t.classList.contains("js-bottom-start-point")&&!this.startFromBottom&&(this.startFrom="js-bottom-start-point",this.startFromTop=!1,this.startFromBottom=!0,this.getPositionA(t,e)),t.classList.contains("js-bottom-start-point")&&(this.saveAnswer=t.parentElement.innerText)}},{key:"getEndPosition",value:function(t,e){var i=this,n=t.classList.contains(this.startFrom);this.isLineStart&&!n&&(this.getPositionB(t,e),setTimeout((function(){i.startFromTop=!1,i.isLineStart=!1}),0))}},{key:"getTouchPositionB",value:function(t){var e=this;if(this.clearCanvas(),this.paintSaveLines(),this.isLineStart){var i=document.elementFromPoint(t.changedTouches[0].clientX,t.changedTouches[0].clientY);if(i.classList.contains("js-drop-point")&&!i.classList.contains(this.startFrom)){var n=+i.getAttribute("data-order");this.elemAttention(i),this.position.x2=this.getCenterPosition(i).x,this.position.y2=this.getCenterPosition(i).y;var s={x1:null,y1:null,x2:null,y2:null};if(s.x1=this.position.x1,s.y1=this.position.y1,s.x2=this.position.x2,s.y2=this.position.y2,this.startFromTop){for(var o in this.saveLines)Object.prototype.hasOwnProperty.call(this.saveLines,o)&&(-1!==o.indexOf(this.saveStartNumber+"top")&&delete this.saveLines[o],-1!==o.indexOf("top"+n)&&delete this.saveLines[o],-1!==o.indexOf(this.saveStartNumber+"bottom")&&delete this.saveLines[o],-1!==o.indexOf(n+"bottom")&&n!==+o[0]&&delete this.saveLines[o],-1!==o.indexOf(n+"top")&&+o[0]!==n&&delete this.saveLines[o],-1!==o.indexOf("bottom"+n)&&delete this.saveLines[o]);this.saveLines[this.saveStartNumber+"top"+n]=s;var r=this.saveStartNumber;setTimeout((function(){e.getUserResult(r,i.parentElement.innerText)}),0)}if(this.startFromBottom){for(var a in this.saveLines)Object.prototype.hasOwnProperty.call(this.saveLines,a)&&(-1!==a.indexOf("bottom"+this.saveStartNumber)&&delete this.saveLines[a],-1!==a.indexOf(n+"bottom")&&delete this.saveLines[a],-1!==a.indexOf("top"+this.saveStartNumber)&&delete this.saveLines[a],-1!==a.indexOf(this.saveStartNumber+"top")&&this.saveStartNumber!==+a[0]&&delete this.saveLines[a],-1!==a.indexOf(n+"top")&&delete this.saveLines[a]);this.saveLines[n+"bottom"+this.saveStartNumber]=s,setTimeout((function(){e.getUserResult(n,e.saveAnswer)}),0)}this.clearCanvas(),this.paintSaveLines(),this.isLineStart=!1,this.startFromTop=!1,this.startFromBottom=!1}}}},{key:"clearOnClick",value:function(t){var e=this;t.classList.contains("js-drop-point")||(this.isLineStart=!1,this.clearCanvas(),this.paintSaveLines(),setTimeout((function(){e.startFromTop=!1,e.startFromBottom=!1,e.isLineStart=!1}),0)),"ontouchstart"in window&&t.classList.contains(this.startFrom)&&(this.isLineStart=!1,this.clearCanvas(),this.paintSaveLines(),setTimeout((function(){e.startFromTop=!1,e.startFromBottom=!1,e.isLineStart=!1}),0))}},{key:"getPositionB",value:function(t,e){var i=this;if(this.isLineStart){this.elemAttention(t),this.position.x2=this.getCenterPosition(t).x,this.position.y2=this.getCenterPosition(t).y;var n={x1:null,y1:null,x2:null,y2:null};if(n.x1=this.position.x1,n.y1=this.position.y1,n.x2=this.position.x2,n.y2=this.position.y2,this.startFromTop){for(var s in this.saveLines)Object.prototype.hasOwnProperty.call(this.saveLines,s)&&(-1!==s.indexOf(this.saveStartNumber+"top")&&delete this.saveLines[s],-1!==s.indexOf("top"+e)&&delete this.saveLines[s],-1!==s.indexOf(this.saveStartNumber+"bottom")&&delete this.saveLines[s],-1!==s.indexOf(e+"bottom")&&e!==+s[0]&&delete this.saveLines[s],-1!==s.indexOf(e+"top")&&+s[0]!==e&&delete this.saveLines[s],-1!==s.indexOf("bottom"+e)&&delete this.saveLines[s]);this.saveLines[this.saveStartNumber+"top"+e]=n;var o=this.saveStartNumber;setTimeout((function(){i.getUserResult(o,i.saveAnswer)}),0)}if(this.startFromBottom){for(var r in this.saveLines)Object.prototype.hasOwnProperty.call(this.saveLines,r)&&(-1!==r.indexOf("bottom"+this.saveStartNumber)&&delete this.saveLines[r],-1!==r.indexOf(e+"bottom")&&delete this.saveLines[r],-1!==r.indexOf("top"+this.saveStartNumber)&&delete this.saveLines[r],-1!==r.indexOf(this.saveStartNumber+"top")&&this.saveStartNumber!==+r[0]&&delete this.saveLines[r],-1!==r.indexOf(e+"top")&&delete this.saveLines[r]);this.saveLines[e+"bottom"+this.saveStartNumber]=n,setTimeout((function(){i.getUserResult(i.saveStartNumber,i.saveAnswer)}),0)}this.clearCanvas(),this.paintSaveLines(),setTimeout((function(){i.isLineStart=!1,i.startFromTop=!1,i.startFromBottom=!1}),0)}}},{key:"paintSaveLines",value:function(){var t=this.canvas.nativeElement.getContext("2d");for(var e in this.saveLines)if(Object.prototype.hasOwnProperty.call(this.saveLines,e)){var i=this.saveLines[e];Object.prototype.hasOwnProperty.call(i,"isCorrect")&&(t.strokeStyle=this.saveLines[e].isCorrect?"#92d050":"#FBACAC");var n=i.x1-this.canvas.nativeElement.getBoundingClientRect().left,s=i.y1-this.canvas.nativeElement.getBoundingClientRect().top,o=i.x2-this.canvas.nativeElement.getBoundingClientRect().left,r=i.y2-this.canvas.nativeElement.getBoundingClientRect().top;t.beginPath(),t.moveTo(n,s),t.lineTo(o,r),t.stroke()}}},{key:"elemAttention",value:function(t){t.classList.add("elem-attention"),setTimeout((function(){t.classList.remove("elem-attention")}),300)}},{key:"getEventPosition",value:function(t){var e,i;return"mousemove"===t.type&&(e=t.clientX,i=t.clientY),"touchmove"===t.type&&(e=t.touches[0].clientX,i=t.touches[0].clientY),{clientX:e,clientY:i}}},{key:"clearCanvas",value:function(){this.canvas.nativeElement.getContext("2d").clearRect(0,0,this.wrapper.nativeElement.getBoundingClientRect().width,this.wrapper.nativeElement.getBoundingClientRect().height)}},{key:"getCenterPosition",value:function(t){var e=t.getBoundingClientRect().width/2,i=t.getBoundingClientRect().top;return{x:t.getBoundingClientRect().left+e,y:i+e}}},{key:"getUserResult",value:function(t,e){for(var i in this.results[t]={Type:"LinkVertical",Order:this.Order,Data:{Order:t,Value:e}},this.results)if(Object.prototype.hasOwnProperty.call(this.results,i)){var n=this.results[i];n.Data.Value===e&&n.Data.Order!==t&&(n.Data.Value=null,this.exerciseDataService.subject.next(n)),this.exerciseDataService.subject.next(n)}}},{key:"ngAfterViewInit",value:function(){this.canvas.nativeElement.width=this.wrapper.nativeElement.getBoundingClientRect().width,this.canvas.nativeElement.height=this.wrapper.nativeElement.getBoundingClientRect().height;var t=this.canvas.nativeElement.getContext("2d");t.strokeStyle="#fccd04",t.lineWidth=this.windowWidth()/100/2}},{key:"windowWidth",value:function(){var t=window,e=document,i=e.documentElement,n=e.getElementsByTagName("body")[0];return t.innerWidth||i.clientWidth||n.clientWidth}}]),t}();return t.\u0275fac=function(e){return new(e||t)(o.Qb(r.a))},t.\u0275cmp=o.Kb({type:t,selectors:[["app-link-vertical"]],viewQuery:function(t,e){var i;1&t&&(o.Hc(a,!0),o.Hc(c,!0)),2&t&&(o.rc(i=o.fc())&&(e.wrapper=i.first),o.rc(i=o.fc())&&(e.canvas=i.first))},inputs:{isCorrectValues:"isCorrectValues",Order:"Order",list:"list"},features:[o.Ab],decls:1,vars:1,consts:[["class","link-vertical-wrapper",3,"blockAfterGetResults","mousemove","touchmove","touchend","click",4,"ngIf"],[1,"link-vertical-wrapper",3,"mousemove","touchmove","touchend","click"],["wrapper",""],[4,"ngFor","ngForOf"],[1,"link-vertical__bottom-wrapper","d-flex"],["class","link-vertical__option bottom_option big-f-size",4,"ngFor","ngForOf"],[1,"canvas"],["canvas",""],["class","link-vertical__top-wrapper d-flex",4,"ngIf"],[1,"link-vertical__top-wrapper","d-flex"],["class","link-vertical__option top_option big-f-size",3,"one_item",4,"ngFor","ngForOf"],[1,"link-vertical__option","top_option","big-f-size"],[1,"option-point","top_point","js-top-start-point","js-top-drop-point","js-start-point","js-drop-point",3,"click","touchstart"],[1,"link-vertical__option","bottom_option","big-f-size"],[1,"option-point","bottom_point","js-bottom-start-point","js-bottom-drop-point","js-start-point","js-drop-point",3,"click","touchstart"]],template:function(t,e){1&t&&o.Cc(0,p,7,4,"div",0),2&t&&o.kc("ngIf",e.resultTopValues)},directives:[n.j,n.i],styles:["[_nghost-%COMP%]{width:100%}.blockAfterGetResults[_ngcontent-%COMP%]{pointer-events:none}.link-vertical-wrapper[_ngcontent-%COMP%]{position:relative}.canvas[_ngcontent-%COMP%]{position:absolute;z-index:-1;top:0;left:0}.link-vertical__option[_ngcontent-%COMP%]{border-radius:100px;padding:1vh 2vw;text-align:center;color:#fff;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;margin:auto;position:relative}.top_option[_ngcontent-%COMP%]{background:#11afa9;min-width:28%}.bottom_option[_ngcontent-%COMP%]{background:#ff712c;min-width:15%;margin:auto auto 0}.link-vertical__top-wrapper[_ngcontent-%COMP%]:nth-child(2){height:20vh}.one_item[_ngcontent-%COMP%]{margin-left:20%}.option-point[_ngcontent-%COMP%]{padding:.7vw;border-radius:50%;cursor:pointer;transition:opacity .2s;position:absolute;left:calc(50% - .35vw)}.top_point[_ngcontent-%COMP%]{background:#0b7570;top:120%}.bottom_point[_ngcontent-%COMP%]{background:#c74200;top:-70%}.link-vertical__bottom-wrapper[_ngcontent-%COMP%]{height:15vh}.elem-attention[_ngcontent-%COMP%]{-webkit-animation:attention .3s;animation:attention .3s}@-webkit-keyframes attention{0%{transform:scale(1)}50%{transform:scale(1.3)}to{transform:scale(1)}}@keyframes attention{0%{transform:scale(1)}50%{transform:scale(1.3)}to{transform:scale(1)}}"]}),t}(),f=function(){var t=function(){function t(e){_classCallCheck(this,t),this.componentFactoryResolver=e}return _createClass(t,[{key:"resolveComponent",value:function(){return this.componentFactoryResolver.resolveComponentFactory(m)}}]),t}();return t.\u0275mod=o.Ob({type:t}),t.\u0275inj=o.Nb({factory:function(e){return new(e||t)(o.ac(o.j))},imports:[[n.b,s.n]]}),t}()}}]);