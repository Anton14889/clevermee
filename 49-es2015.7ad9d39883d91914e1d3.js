(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{Nns5:function(t,e,i){"use strict";i.r(e),i.d(e,"LinkVerticalComponent",(function(){return m})),i.d(e,"LinkVerticalModule",(function(){return d}));var s=i("ofXK"),n=i("3Pt+"),o=i("fXoL"),r=i("XCOF");const a=["wrapper"],c=["canvas"];function l(t,e){if(1&t){const t=o.Xb();o.Wb(0,"div",11),o.Dc(1),o.Wb(2,"div",12),o.ec("click",(function(i){o.vc(t);const s=e.$implicit,n=o.hc(4);return[n.getEndPosition(i.target,s.order),n.getStartPosition(i.target,s.order)]}))("touchstart",(function(i){o.vc(t);const s=e.$implicit;return o.hc(4).getStartPosition(i.target,s.order)})),o.Vb(),o.Vb()}if(2&t){const t=e.$implicit;o.Gb("one_item",t.isOneInTwoRow),o.Cb(1),o.Fc(" ",t.value," "),o.Cb(1),o.Db("data-order",t.order)}}function h(t,e){if(1&t&&(o.Wb(0,"div",9),o.Cc(1,l,3,4,"div",10),o.Vb()),2&t){const t=o.hc().$implicit;o.Cb(1),o.kc("ngForOf",t)}}function p(t,e){if(1&t&&(o.Ub(0),o.Cc(1,h,2,1,"div",8),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.kc("ngIf",t.length)}}function u(t,e){if(1&t){const t=o.Xb();o.Wb(0,"div",13),o.Dc(1),o.Wb(2,"div",14),o.ec("click",(function(i){o.vc(t);const s=e.$implicit,n=o.hc(2);return[n.getEndPosition(i.target,s.order),n.getStartPosition(i.target,s.order)]}))("touchstart",(function(i){o.vc(t);const s=e.$implicit;return o.hc(2).getStartPosition(i.target,s.order)})),o.Vb(),o.Vb()}if(2&t){const t=e.$implicit;o.Cb(1),o.Fc(" ",t.value," "),o.Cb(1),o.Db("data-order",t.order)}}function v(t,e){if(1&t){const t=o.Xb();o.Wb(0,"div",1,2),o.ec("mousemove",(function(e){return o.vc(t),o.hc().lineMove(e)}))("touchmove",(function(e){return o.vc(t),o.hc().lineMove(e)}))("touchend",(function(e){return o.vc(t),o.hc().getTouchPositionB(e)}))("click",(function(e){return o.vc(t),o.hc().clearOnClick(e.target)})),o.Cc(2,p,2,1,"ng-container",3),o.Wb(3,"div",4),o.Cc(4,u,3,2,"div",5),o.Vb(),o.Rb(5,"canvas",6,7),o.Vb()}if(2&t){const t=o.hc();o.Gb("blockAfterGetResults",t.isCorrectValues),o.Cb(2),o.kc("ngForOf",t.resultTopValues),o.Cb(2),o.kc("ngForOf",t.resultBottomValues)}}let m=(()=>{class t{constructor(t){this.exerciseDataService=t,this.position={x1:null,y1:null,x2:null,y2:null},this.results={},this.saveLines={},this.isLineStart=!1,this.startFrom=""}ngOnChanges(){if(this.list.sort((t,e)=>t.Order-e.Order),this.isCorrectValues){this.saveLines={};const t=document.getElementsByClassName("js-top-start-point"),e=document.getElementsByClassName("js-bottom-start-point");return this.list.forEach((i,s)=>{let n,o;this.resultTopValues.forEach(s=>{s.forEach(s=>{this.resultBottomValues.forEach((r,a)=>{s.order===i.Order&&r.value===i.CorrectValue&&(n=t[i.Order-1],o=e[a])})})}),this.saveLines[s]={isCorrect:null,x1:null,y1:null,x2:null,y2:null},this.saveLines[s].isCorrect=i.IsCorrect,this.saveLines[s].x1=this.getCenterPosition(n).x,this.saveLines[s].y1=this.getCenterPosition(n).y,this.saveLines[s].x2=this.getCenterPosition(o).x,this.saveLines[s].y2=this.getCenterPosition(o).y}),this.clearCanvas(),void this.paintSaveLines()}const t=[],e=[];this.list.forEach(i=>{const s={order:i.Order,value:i.Value,isOneInTwoRow:null};"BottomValue"===i.Metric&&t.push(s),"TopValue"===i.Metric&&e.push(s)});const i=[[],[]];e.forEach((t,e)=>{e<3?i[0].push(t):i[1].push(t)}),1===i[1].length&&(i[1][0].isOneInTwoRow=!0),this.resultTopValues=i,this.resultBottomValues=t}lineMove(t){if(!this.isLineStart)return;const e=this.wrapper.nativeElement.getBoundingClientRect().left,i=this.wrapper.nativeElement.getBoundingClientRect().top,s=this.getEventPosition(t).clientX-e,n=this.getEventPosition(t).clientY-i,o=this.position.x1-e,r=this.position.y1-i,a=this.canvas.nativeElement.getContext("2d");this.clearCanvas(),a.beginPath(),a.moveTo(o,r),a.lineTo(s,n),a.stroke(),this.paintSaveLines()}getPositionA(t,e){this.elemAttention(t),this.position.x1=this.getCenterPosition(t).x,this.position.y1=this.getCenterPosition(t).y,this.isLineStart=!0,this.saveStartNumber=e}getStartPosition(t,e){t.classList.contains("js-top-start-point")&&!this.startFromTop&&(this.startFrom="js-top-start-point",this.startFromTop=!0,this.startFromBottom=!1,this.getPositionA(t,e)),t.classList.contains("js-bottom-start-point")&&!this.startFromBottom&&(this.startFrom="js-bottom-start-point",this.startFromTop=!1,this.startFromBottom=!0,this.getPositionA(t,e)),t.classList.contains("js-bottom-start-point")&&(this.saveAnswer=t.parentElement.innerText)}getEndPosition(t,e){const i=t.classList.contains(this.startFrom);this.isLineStart&&!i&&(this.getPositionB(t,e),setTimeout(()=>{this.startFromTop=!1,this.isLineStart=!1},0))}getTouchPositionB(t){if(this.clearCanvas(),this.paintSaveLines(),!this.isLineStart)return;const e=document.elementFromPoint(t.changedTouches[0].clientX,t.changedTouches[0].clientY);if(e.classList.contains("js-drop-point")&&!e.classList.contains(this.startFrom)){const t=+e.getAttribute("data-order");this.elemAttention(e),this.position.x2=this.getCenterPosition(e).x,this.position.y2=this.getCenterPosition(e).y;const i={x1:null,y1:null,x2:null,y2:null};if(i.x1=this.position.x1,i.y1=this.position.y1,i.x2=this.position.x2,i.y2=this.position.y2,this.startFromTop){for(const e in this.saveLines)Object.prototype.hasOwnProperty.call(this.saveLines,e)&&(-1!==e.indexOf(this.saveStartNumber+"top")&&delete this.saveLines[e],-1!==e.indexOf("top"+t)&&delete this.saveLines[e],-1!==e.indexOf(this.saveStartNumber+"bottom")&&delete this.saveLines[e],-1!==e.indexOf(t+"bottom")&&t!==+e[0]&&delete this.saveLines[e],-1!==e.indexOf(t+"top")&&+e[0]!==t&&delete this.saveLines[e],-1!==e.indexOf("bottom"+t)&&delete this.saveLines[e]);this.saveLines[this.saveStartNumber+"top"+t]=i;const s=this.saveStartNumber;setTimeout(()=>{this.getUserResult(s,e.parentElement.innerText)},0)}if(this.startFromBottom){for(const e in this.saveLines)Object.prototype.hasOwnProperty.call(this.saveLines,e)&&(-1!==e.indexOf("bottom"+this.saveStartNumber)&&delete this.saveLines[e],-1!==e.indexOf(t+"bottom")&&delete this.saveLines[e],-1!==e.indexOf("top"+this.saveStartNumber)&&delete this.saveLines[e],-1!==e.indexOf(this.saveStartNumber+"top")&&this.saveStartNumber!==+e[0]&&delete this.saveLines[e],-1!==e.indexOf(t+"top")&&delete this.saveLines[e]);this.saveLines[t+"bottom"+this.saveStartNumber]=i,setTimeout(()=>{this.getUserResult(t,this.saveAnswer)},0)}this.clearCanvas(),this.paintSaveLines(),this.isLineStart=!1,this.startFromTop=!1,this.startFromBottom=!1}}clearOnClick(t){t.classList.contains("js-drop-point")||(this.isLineStart=!1,this.clearCanvas(),this.paintSaveLines(),setTimeout(()=>{this.startFromTop=!1,this.startFromBottom=!1,this.isLineStart=!1},0)),"ontouchstart"in window&&t.classList.contains(this.startFrom)&&(this.isLineStart=!1,this.clearCanvas(),this.paintSaveLines(),setTimeout(()=>{this.startFromTop=!1,this.startFromBottom=!1,this.isLineStart=!1},0))}getPositionB(t,e){if(!this.isLineStart)return;this.elemAttention(t),this.position.x2=this.getCenterPosition(t).x,this.position.y2=this.getCenterPosition(t).y;const i={x1:null,y1:null,x2:null,y2:null};if(i.x1=this.position.x1,i.y1=this.position.y1,i.x2=this.position.x2,i.y2=this.position.y2,this.startFromTop){for(const i in this.saveLines)Object.prototype.hasOwnProperty.call(this.saveLines,i)&&(-1!==i.indexOf(this.saveStartNumber+"top")&&delete this.saveLines[i],-1!==i.indexOf("top"+e)&&delete this.saveLines[i],-1!==i.indexOf(this.saveStartNumber+"bottom")&&delete this.saveLines[i],-1!==i.indexOf(e+"bottom")&&e!==+i[0]&&delete this.saveLines[i],-1!==i.indexOf(e+"top")&&+i[0]!==e&&delete this.saveLines[i],-1!==i.indexOf("bottom"+e)&&delete this.saveLines[i]);this.saveLines[this.saveStartNumber+"top"+e]=i;const t=this.saveStartNumber;setTimeout(()=>{this.getUserResult(t,this.saveAnswer)},0)}if(this.startFromBottom){for(const t in this.saveLines)Object.prototype.hasOwnProperty.call(this.saveLines,t)&&(-1!==t.indexOf("bottom"+this.saveStartNumber)&&delete this.saveLines[t],-1!==t.indexOf(e+"bottom")&&delete this.saveLines[t],-1!==t.indexOf("top"+this.saveStartNumber)&&delete this.saveLines[t],-1!==t.indexOf(this.saveStartNumber+"top")&&this.saveStartNumber!==+t[0]&&delete this.saveLines[t],-1!==t.indexOf(e+"top")&&delete this.saveLines[t]);this.saveLines[e+"bottom"+this.saveStartNumber]=i,setTimeout(()=>{this.getUserResult(this.saveStartNumber,this.saveAnswer)},0)}this.clearCanvas(),this.paintSaveLines(),setTimeout(()=>{this.isLineStart=!1,this.startFromTop=!1,this.startFromBottom=!1},0)}paintSaveLines(){const t=this.canvas.nativeElement.getContext("2d");for(const e in this.saveLines)if(Object.prototype.hasOwnProperty.call(this.saveLines,e)){const i=this.saveLines[e];Object.prototype.hasOwnProperty.call(i,"isCorrect")&&(t.strokeStyle=this.saveLines[e].isCorrect?"#92d050":"#FBACAC");const s=i.x1-this.canvas.nativeElement.getBoundingClientRect().left,n=i.y1-this.canvas.nativeElement.getBoundingClientRect().top,o=i.x2-this.canvas.nativeElement.getBoundingClientRect().left,r=i.y2-this.canvas.nativeElement.getBoundingClientRect().top;t.beginPath(),t.moveTo(s,n),t.lineTo(o,r),t.stroke()}}elemAttention(t){t.classList.add("elem-attention"),setTimeout(()=>{t.classList.remove("elem-attention")},300)}getEventPosition(t){let e,i;return"mousemove"===t.type&&(e=t.clientX,i=t.clientY),"touchmove"===t.type&&(e=t.touches[0].clientX,i=t.touches[0].clientY),{clientX:e,clientY:i}}clearCanvas(){this.canvas.nativeElement.getContext("2d").clearRect(0,0,this.wrapper.nativeElement.getBoundingClientRect().width,this.wrapper.nativeElement.getBoundingClientRect().height)}getCenterPosition(t){const e=t.getBoundingClientRect().width/2,i=t.getBoundingClientRect().top;return{x:t.getBoundingClientRect().left+e,y:i+e}}getUserResult(t,e){this.results[t]={Type:"LinkVertical",Order:this.Order,Data:{Order:t,Value:e}};for(const i in this.results)if(Object.prototype.hasOwnProperty.call(this.results,i)){const s=this.results[i];s.Data.Value===e&&s.Data.Order!==t&&(s.Data.Value=null,this.exerciseDataService.subject.next(s)),this.exerciseDataService.subject.next(s)}}ngAfterViewInit(){this.canvas.nativeElement.width=this.wrapper.nativeElement.getBoundingClientRect().width,this.canvas.nativeElement.height=this.wrapper.nativeElement.getBoundingClientRect().height;const t=this.canvas.nativeElement.getContext("2d");t.strokeStyle="#fccd04",t.lineWidth=this.windowWidth()/100/2}windowWidth(){const t=window,e=document,i=e.documentElement,s=e.getElementsByTagName("body")[0];return t.innerWidth||i.clientWidth||s.clientWidth}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(r.a))},t.\u0275cmp=o.Kb({type:t,selectors:[["app-link-vertical"]],viewQuery:function(t,e){var i;1&t&&(o.Hc(a,!0),o.Hc(c,!0)),2&t&&(o.rc(i=o.fc())&&(e.wrapper=i.first),o.rc(i=o.fc())&&(e.canvas=i.first))},inputs:{isCorrectValues:"isCorrectValues",Order:"Order",list:"list"},features:[o.Ab],decls:1,vars:1,consts:[["class","link-vertical-wrapper",3,"blockAfterGetResults","mousemove","touchmove","touchend","click",4,"ngIf"],[1,"link-vertical-wrapper",3,"mousemove","touchmove","touchend","click"],["wrapper",""],[4,"ngFor","ngForOf"],[1,"link-vertical__bottom-wrapper","d-flex"],["class","link-vertical__option bottom_option big-f-size",4,"ngFor","ngForOf"],[1,"canvas"],["canvas",""],["class","link-vertical__top-wrapper d-flex",4,"ngIf"],[1,"link-vertical__top-wrapper","d-flex"],["class","link-vertical__option top_option big-f-size",3,"one_item",4,"ngFor","ngForOf"],[1,"link-vertical__option","top_option","big-f-size"],[1,"option-point","top_point","js-top-start-point","js-top-drop-point","js-start-point","js-drop-point",3,"click","touchstart"],[1,"link-vertical__option","bottom_option","big-f-size"],[1,"option-point","bottom_point","js-bottom-start-point","js-bottom-drop-point","js-start-point","js-drop-point",3,"click","touchstart"]],template:function(t,e){1&t&&o.Cc(0,v,7,4,"div",0),2&t&&o.kc("ngIf",e.resultTopValues)},directives:[s.j,s.i],styles:["[_nghost-%COMP%]{width:100%}.blockAfterGetResults[_ngcontent-%COMP%]{pointer-events:none}.link-vertical-wrapper[_ngcontent-%COMP%]{position:relative}.canvas[_ngcontent-%COMP%]{position:absolute;z-index:-1;top:0;left:0}.link-vertical__option[_ngcontent-%COMP%]{border-radius:100px;padding:1vh 2vw;text-align:center;color:#fff;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;margin:auto;position:relative}.top_option[_ngcontent-%COMP%]{background:#11afa9;min-width:28%}.bottom_option[_ngcontent-%COMP%]{background:#ff712c;min-width:15%;margin:auto auto 0}.link-vertical__top-wrapper[_ngcontent-%COMP%]:nth-child(2){height:20vh}.one_item[_ngcontent-%COMP%]{margin-left:20%}.option-point[_ngcontent-%COMP%]{padding:.7vw;border-radius:50%;cursor:pointer;transition:opacity .2s;position:absolute;left:calc(50% - .35vw)}.top_point[_ngcontent-%COMP%]{background:#0b7570;top:120%}.bottom_point[_ngcontent-%COMP%]{background:#c74200;top:-70%}.link-vertical__bottom-wrapper[_ngcontent-%COMP%]{height:15vh}.elem-attention[_ngcontent-%COMP%]{-webkit-animation:attention .3s;animation:attention .3s}@-webkit-keyframes attention{0%{transform:scale(1)}50%{transform:scale(1.3)}to{transform:scale(1)}}@keyframes attention{0%{transform:scale(1)}50%{transform:scale(1.3)}to{transform:scale(1)}}"]}),t})(),d=(()=>{class t{constructor(t){this.componentFactoryResolver=t}resolveComponent(){return this.componentFactoryResolver.resolveComponentFactory(m)}}return t.\u0275mod=o.Ob({type:t}),t.\u0275inj=o.Nb({factory:function(e){return new(e||t)(o.ac(o.j))},imports:[[s.b,n.n]]}),t})()}}]);