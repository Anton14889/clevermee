(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{ErRH:function(e,t,s){"use strict";s.r(t),s.d(t,"HighLightTextsComponent",(function(){return u})),s.d(t,"HighLightTextsModule",(function(){return g}));var i=s("ofXK"),n=s("3Pt+"),o=s("fXoL"),r=s("XCOF");function h(e,t){if(1&e&&(o.Ub(0),o.Wb(1,"span",7),o.Dc(2),o.Vb(),o.Tb()),2&e){const e=t.$implicit,s=t.index;o.Cb(1),o.Gb("js-elem"," "!==e)("high-light__texts-empty"," "===e),o.Db("data-order",s),o.Cb(1),o.Fc(" ",e," ")}}function a(e,t){if(1&e&&(o.Ub(0),o.Cc(1,h,3,6,"ng-container",6),o.Tb()),2&e){const e=o.hc().$implicit;o.Cb(1),o.kc("ngForOf",e.valueArray)}}function l(e,t){if(1&e){const e=o.Xb();o.Wb(0,"div",3),o.ec("mousemove",(function(s){o.vc(e);const i=t.index;return o.hc(2).mousemove(s,i)}))("mousedown",(function(t){return o.vc(e),o.hc(2).mousedown(t)}))("mouseup",(function(s){o.vc(e);const i=t.index;return o.hc(2).mouseup(s,i)}))("mouseleave",(function(){o.vc(e);const s=t.index;return o.hc(2).mouseleave(s)}))("touchend",(function(s){o.vc(e);const i=t.index;return o.hc(2).mouseup(s,i)}))("touchstart",(function(t){return o.vc(e),o.hc(2).mousedown(t)}))("touchleave",(function(){o.vc(e);const s=t.index;return o.hc(2).mouseleave(s)})),o.Cc(1,a,2,1,"ng-container",4),o.Rb(2,"canvas",5),o.Vb()}if(2&e){const e=t.$implicit;o.Cb(1),o.kc("ngIf",e.valueArray)}}function c(e,t){if(1&e&&(o.Wb(0,"div",1),o.Cc(1,l,3,1,"div",2),o.Vb()),2&e){const e=o.hc();o.Cb(1),o.kc("ngForOf",e.highLightTextsArray)}}let u=(()=>{class e{constructor(e){this.exerciseDataService=e,this.saveCanvasElems=[],this.saveWrappersElems=[],this.saveuserAnswers={},this.position={x1:null,y1:null,x2:null,y2:null},this.saveTouchPosition={x:null,y:null},this.lineHeight={border:null,height:null},this.saveLines={}}ngOnChanges(){if(this.list.sort((e,t)=>e.Order-t.Order),this.isCorrectValues){let e,t,s;console.log(this.list);const i=[];this.list.forEach((n,o)=>{let r="";if(this.saveWrappersElems[o/2]&&(e=this.saveWrappersElems[o/2].getElementsByClassName("js-elem")),Array.from(e).forEach(e=>{r+=e.innerText}),r.includes(n.CorrectValue.replace(/\s/g,""))){const o=n.CorrectValue.replace(/\s/g,"");let r=e.length,h=0;for(;r>0;){const s=e[h];if(t!==s&&s.innerText===o[0]){t=s,i.push(e[h]);break}h++,r--}let a=e.length,l=0;for(;a>0;){const t=e[l];if(s!==t&&t.innerText===o[o.length-1]){s=t,i.push(e[l]);break}l++,a--}}}),this.saveLines={};let n=0;i.forEach((e,t)=>{if(t%4==0){const s={x1:this.getCenterPosition(e).x,y1:this.getCenterPosition(e).y,x2:this.getCenterPosition(i[t+1]).x,y2:this.getCenterPosition(e).y,isOneColor:!0};this.saveLines[n++]=s}else{const s={x1:this.getCenterPosition(i[t-1]).x,y1:this.getCenterPosition(e).y,x2:this.getCenterPosition(i[t]).x,y2:this.getCenterPosition(e).y,isOneColor:!1};this.saveLines[n]=s}});for(const o in this.saveLines)if(Object.prototype.hasOwnProperty.call(this.saveLines,o)&&this.saveCanvasElems[o]){const e=this.saveCanvasElems[o].getContext("2d");this.paintSaveLines(e,+o)}return}const e=[];this.list.forEach(t=>{const s={IsCorrect:null,CorrectValue:null,valueArray:t.Value.split(""),order:t.Order};e.push(s)}),this.highLightTextsArray=e}mousemove(e,t){if(!this.mouseStart)return;const s=document.elementFromPoint(this.getEventPosition(e).clientX,this.getEventPosition(e).clientY);if(" "===s.innerHTML)return;if(!s.classList.contains("high-light__texts-letter"))return;const i=this.saveWrappersElems[t].getBoundingClientRect().left,n=this.saveWrappersElems[t].getBoundingClientRect().top,o=this.position.x1-i,r=this.position.y1-n,h=this.getCenterPosition(s).x-i,a=this.getCenterPosition(s).y-n,l=this.saveCanvasElems[t].getContext("2d");this.clearCanvas(t),this.paintLine(l,o,r,h,a,!this.saveLines[t]),this.paintSaveLines(l,t)}mousedown(e){this.mouseStart=!0;const t=document.elementFromPoint(this.getEventPosition(e).clientX,this.getEventPosition(e).clientY);this.position.x1=this.getCenterPosition(t).x,this.position.y1=this.getCenterPosition(t).y}mouseup(e,t){this.clearCanvas(t);const s=this.saveCanvasElems[t].getContext("2d");if(this.paintSaveLines(s,t),!this.mouseStart)return;const i=document.elementFromPoint(this.getEventPosition(e).clientX,this.getEventPosition(e).clientY);if(" "===i.innerHTML)return void(this.mouseStart=!1);if(!i.classList.contains("high-light__texts-letter"))return void(this.mouseStart=!1);this.mouseStart=!1;const n={x1:null,y1:null,x2:null,y2:null,isOneColor:null};if(n.x1=this.position.x1,n.y1=this.position.y1,n.x2=this.getCenterPosition(i).x,n.y2=this.getCenterPosition(i).y,this.saveLines[t]){const e=this.saveLines[t].x1<this.saveLines[t].x2?this.saveLines[t].x1:this.saveLines[t].x2,s=this.saveLines[t].x1>this.saveLines[t].x2?this.saveLines[t].x1:this.saveLines[t].x2,i=n.x1<n.x2?n.x1:n.x2,o=n.x1>n.x2?n.x1:n.x2;(i>o?o:i)<=(e>s?e:s)&&(delete this.saveLines[t],delete this.saveLines[t+"x"],delete this.saveuserAnswers[t+1+".1"],delete this.saveuserAnswers[t+1+".2"])}this.saveLines[t]?(this.saveLines[t+"x"]=n,n.isOneColor=!1,this.getUserValues(n.x1,n.x2,n.y1,t+1+".2",t)):(this.saveLines[t]=n,n.isOneColor=!0,this.getUserValues(n.x1,n.x2,n.y1,t+1+".1",t));for(const o in this.saveuserAnswers)Object.prototype.hasOwnProperty.call(this.saveuserAnswers,o)&&(-1!==o.indexOf(".2")?this.getUserResult(this.saveuserAnswers[o],2*+o[0]):this.getUserResult(this.saveuserAnswers[o],2*+o[0]-1));this.clearCanvas(t),this.paintSaveLines(s,t)}paintSaveLines(e,t){const s=this.saveWrappersElems[t].getBoundingClientRect().left,i=this.saveWrappersElems[t].getBoundingClientRect().top;for(const n in this.saveLines)if(Object.prototype.hasOwnProperty.call(this.saveLines,n)){const t=this.saveLines[n];Object.prototype.hasOwnProperty.call(t,"isCorrect")&&(e.strokeStyle=this.saveLines[n].isCorrect?"#92d050":"#FBACAC"),this.paintLine(e,t.x1-s,t.y1-i,t.x2-s,t.y2-i,t.isOneColor)}}getUserValues(e,t,s,i,n){let o=e<t?e:t;const r=e>t?e:t;let h="";const a={};for(;o<=r;){const e=document.elementFromPoint(o,s);a[e.getAttribute("data-order")]=e.innerText,o+=this.elemWidth}const l=document.elementFromPoint(r,s);a[l.getAttribute("data-order")]=l.innerText;for(const c in a)Object.prototype.hasOwnProperty.call(a,c)&&"null"!==c&&(h+=a[c]);this.saveuserAnswers[i]=h}getEventPosition(e){let t,s;return"mousemove"!==e.type&&"mousedown"!==e.type&&"mouseup"!==e.type||(t=e.clientX,s=e.clientY),"touchmove"!==e.type&&"touchstart"!==e.type||(t=e.touches[0].clientX,s=e.touches[0].clientY,this.saveTouchPosition.x=e.touches[0].clientX,this.saveTouchPosition.y=e.touches[0].clientY),"touchend"===e.type?{clientX:this.saveTouchPosition.x,clientY:this.saveTouchPosition.y}:{clientX:t,clientY:s}}getCenterPosition(e){const t=e.getBoundingClientRect().height/1.79,s=e.getBoundingClientRect().width/2,i=e.getBoundingClientRect().top;return{x:e.getBoundingClientRect().left+s,y:i+t}}clearCanvas(e){this.saveCanvasElems[e].getContext("2d").clearRect(0,0,this.saveWrappersElems[e].getBoundingClientRect().width,this.saveWrappersElems[e].getBoundingClientRect().height)}mouseleave(e){if(!this.mouseStart)return;this.mouseStart=!1,this.clearCanvas(e);const t=this.saveCanvasElems[e].getContext("2d");this.paintSaveLines(t,e)}paintLine(e,t,s,i,n,o){e.lineWidth=this.lineHeight.border,e.strokeStyle=o?"#025b51":"#893203",e.beginPath(),e.moveTo(t,s),e.lineTo(i,n),e.stroke(),e.lineWidth=this.lineHeight.height,e.strokeStyle=o?"#bce2c0":"#f6cf99",e.beginPath(),e.moveTo(t,s),e.lineTo(i,n),e.stroke()}getUserResult(e,t){this.exerciseDataService.subject.next({Type:"HighlightTexts",Order:this.Order,Data:{Order:t,Value:e}})}ngAfterViewInit(){const e=document.getElementsByClassName("high-light__texts-wrapper"),t=document.getElementsByClassName("high-light__canvas"),s=document.getElementsByClassName("high-light__texts-letter")[0].getBoundingClientRect();this.lineHeight.height=s.height-s.height/100*30,this.lineHeight.border=s.height-s.height/100*15,this.elemWidth=s.width,Array.from(e).forEach((e,s)=>{const i=t[s],n=e.getBoundingClientRect().width,o=e.getBoundingClientRect().height;i.width=n,i.height=o;const r=i.getContext("2d");r.lineCap="round",r.globalAlpha=.5,this.saveCanvasElems.push(i),this.saveWrappersElems.push(e)})}}return e.\u0275fac=function(t){return new(t||e)(o.Qb(r.a))},e.\u0275cmp=o.Kb({type:e,selectors:[["app-high-light-texts"]],inputs:{isCorrectValues:"isCorrectValues",Order:"Order",list:"list"},features:[o.Ab],decls:1,vars:1,consts:[["class","high-light-wrapper m-auto",4,"ngIf"],[1,"high-light-wrapper","m-auto"],["class","high-light__texts-wrapper big-f-size text-center",3,"mousemove","mousedown","mouseup","mouseleave","touchend","touchstart","touchleave",4,"ngFor","ngForOf"],[1,"high-light__texts-wrapper","big-f-size","text-center",3,"mousemove","mousedown","mouseup","mouseleave","touchend","touchstart","touchleave"],[4,"ngIf"],[1,"canvas","high-light__canvas"],[4,"ngFor","ngForOf"],[1,"high-light__texts-letter"]],template:function(e,t){1&e&&o.Cc(0,c,2,1,"div",0),2&e&&o.kc("ngIf",t.highLightTextsArray)},directives:[i.j,i.i],styles:[".high-light-wrapper[_ngcontent-%COMP%]{width:25vw}.high-light__texts-wrapper[_ngcontent-%COMP%]{padding:1vh 2vw;border-radius:10vh;width:100%;position:relative}.high-light__texts-wrapper[_ngcontent-%COMP%]:not(:last-of-type){margin-bottom:2vh}.high-light__texts-letter[_ngcontent-%COMP%]{display:inline-block;width:.9em;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.high-light__texts-empty[_ngcontent-%COMP%]{display:inline-block;width:.25em}.canvas[_ngcontent-%COMP%]{z-index:-1;position:absolute;top:0;left:0;background:#fbf7cb;border-radius:10vh}"]}),e})(),g=(()=>{class e{constructor(e){this.componentFactoryResolver=e}resolveComponent(){return this.componentFactoryResolver.resolveComponentFactory(u)}}return e.\u0275mod=o.Ob({type:e}),e.\u0275inj=o.Nb({factory:function(t){return new(t||e)(o.ac(o.j))},imports:[[i.b,n.n]]}),e})()}}]);