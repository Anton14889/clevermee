(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{QnFG:function(t,e,i){"use strict";i.r(e),i.d(e,"LinkImagesToNumbersComponent",(function(){return d})),i.d(e,"LinkImagesToNumbersModule",(function(){return v}));var n=i("ofXK"),s=i("3Pt+"),o=i("fXoL"),r=i("XCOF"),a=i("TznM");const c=["wrapper"],l=["canvas"];function h(t,e){if(1&t){const t=o.Xb();o.Wb(0,"div",12),o.Wb(1,"div",13),o.Rb(2,"img",14),o.Rb(3,"div",15),o.Vb(),o.Wb(4,"div",16),o.ec("click",(function(i){o.vc(t);const n=e.$implicit,s=o.hc(4);return[s.getEndPosition(i.target,n.order),s.getStartPosition(i.target,n.order)]}))("touchstart",(function(i){o.vc(t);const n=e.$implicit;return o.hc(4).getStartPosition(i.target,n.order)})),o.Vb(),o.Vb()}if(2&t){const t=e.$implicit,i=o.hc(4);o.Cb(2),o.kc("src",i.resourceLoadsService.getExerciseImage(t.img),o.xc),o.Cb(1),o.Gb("left__img-value_center",i.IsImageTextCentered),o.kc("innerHTML",t.value,o.wc),o.Cb(1),o.Db("data-order",t.order)}}function u(t,e){if(1&t&&(o.Wb(0,"div",10),o.Cc(1,h,5,5,"div",11),o.Vb()),2&t){const t=o.hc().$implicit;o.Cb(1),o.kc("ngForOf",t)}}function m(t,e){if(1&t&&(o.Ub(0),o.Cc(1,u,2,1,"div",9),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.kc("ngIf",t.length)}}function g(t,e){if(1&t){const t=o.Xb();o.Wb(0,"div",17),o.Dc(1),o.Wb(2,"div",18),o.ec("click",(function(i){o.vc(t);const n=e.$implicit,s=o.hc(2);return[s.getEndPosition(i.target,n.order),s.getStartPosition(i.target,n.order)]}))("touchstart",(function(i){o.vc(t);const n=e.$implicit;return o.hc(2).getStartPosition(i.target,n.order)})),o.Vb(),o.Vb()}if(2&t){const t=e.$implicit;o.Cb(1),o.Fc(" ",t.value," "),o.Cb(1),o.Db("data-order",t.order)}}function p(t,e){if(1&t){const t=o.Xb();o.Wb(0,"div",1,2),o.ec("mousemove",(function(e){return o.vc(t),o.hc().lineMove(e)}))("touchmove",(function(e){return o.vc(t),o.hc().lineMove(e)}))("touchend",(function(e){return o.vc(t),o.hc().getTouchPositionB(e)}))("click",(function(e){return o.vc(t),o.hc().clearOnClick(e.target)})),o.Wb(2,"div",3),o.Cc(3,m,2,1,"ng-container",4),o.Vb(),o.Wb(4,"div",5),o.Cc(5,g,3,2,"div",6),o.Vb(),o.Rb(6,"canvas",7,8),o.Vb()}if(2&t){const t=o.hc();o.Gb("blockAfterGetResults",t.isCorrectValues),o.Cb(3),o.kc("ngForOf",t.resultTopValues),o.Cb(2),o.kc("ngForOf",t.resultBottomValues)}}let d=(()=>{class t{constructor(t,e){this.exerciseDataService=t,this.resourceLoadsService=e,this.position={x1:null,y1:null,x2:null,y2:null},this.results={},this.saveLines={},this.isLineStart=!1,this.startFrom=""}ngOnChanges(){if(this.list.sort((t,e)=>t.Order-e.Order),this.isCorrectValues){this.saveLines={};const t=document.getElementsByClassName("js-top-start-point"),e=document.getElementsByClassName("js-bottom-start-point");return this.list.forEach((i,n)=>{let s,o;this.resultTopValues.forEach(n=>{n.forEach(n=>{this.resultBottomValues.forEach((r,a)=>{n.order===i.Order&&r.order===+i.CorrectValue&&(s=t[i.Order-1],o=e[a])})})}),this.saveLines[n]={isCorrect:null,x1:null,y1:null,x2:null,y2:null},this.saveLines[n].isCorrect=i.IsCorrect,this.saveLines[n].x1=this.getCenterPosition(s).x,this.saveLines[n].y1=this.getCenterPosition(s).y,this.saveLines[n].x2=this.getCenterPosition(o).x,this.saveLines[n].y2=this.getCenterPosition(o).y}),this.clearCanvas(),void this.paintSaveLines()}const t=[],e=[],i=[];this.list.forEach(n=>{const s={order:n.Order,value:n.Value};"IsImageTextCentered"===n.Metric&&(this.IsImageTextCentered="True"===n.Value),"OptionValue"===n.Metric&&t.push(s),"ImageName"===n.Metric&&e.push(s),"ImageValue"===n.Metric&&i.push(s)});const n=[];e.forEach(t=>{i.forEach(e=>{t.order===e.order&&n.push({order:t.order,img:t.value,value:e.value})})});const s=[[],[]];n.forEach((t,e)=>{e<3?s[0].push(t):s[1].push(t)}),this.resultTopValues=s,this.resultBottomValues=t}lineMove(t){if(!this.isLineStart)return;const e=this.wrapper.nativeElement.getBoundingClientRect().left,i=this.wrapper.nativeElement.getBoundingClientRect().top,n=this.getEventPosition(t).clientX-e,s=this.getEventPosition(t).clientY-i,o=this.position.x1-e,r=this.position.y1-i,a=this.canvas.nativeElement.getContext("2d");this.clearCanvas(),a.beginPath(),a.moveTo(o,r),a.lineTo(n,s),a.stroke(),this.paintSaveLines()}getPositionA(t,e){this.elemAttention(t),this.position.x1=this.getCenterPosition(t).x,this.position.y1=this.getCenterPosition(t).y,this.isLineStart=!0,this.saveStartNumber=e}getStartPosition(t,e){this.elemAttention(t),t.classList.contains("js-top-start-point")&&!this.startFromLeft&&(this.startFrom="js-top-start-point",this.startFromLeft=!0,this.startFromRight=!1,this.getPositionA(t,e)),t.classList.contains("js-bottom-start-point")&&!this.startFromRight&&(this.startFrom="js-bottom-start-point",this.startFromLeft=!1,this.startFromRight=!0,this.getPositionA(t,null)),t.classList.contains("js-bottom-start-point")&&(this.saveAnswerOrder=t.getAttribute("data-order"))}getEndPosition(t,e){const i=t.classList.contains(this.startFrom);this.isLineStart&&!i&&(this.getPositionB(t,e),setTimeout(()=>{this.startFromLeft=!1,this.isLineStart=!1},0))}getTouchPositionB(t){if(this.clearCanvas(),this.paintSaveLines(),!this.isLineStart)return;const e=document.elementFromPoint(t.changedTouches[0].clientX,t.changedTouches[0].clientY);if(e.classList.contains("js-drop-point")&&!e.classList.contains(this.startFrom)){const t=+e.getAttribute("data-order");this.elemAttention(e),this.position.x2=this.getCenterPosition(e).x,this.position.y2=this.getCenterPosition(e).y;const i={x1:null,y1:null,x2:null,y2:null};if(i.x1=this.position.x1,i.y1=this.position.y1,i.x2=this.position.x2,i.y2=this.position.y2,this.startFromLeft){this.saveLines[this.saveStartNumber]=i;const e=this.saveStartNumber;setTimeout(()=>{this.getUserResult(e,t+"")},0)}this.startFromRight&&(this.saveLines[t]=i,setTimeout(()=>{this.getUserResult(t,this.saveAnswerOrder)},0)),this.clearCanvas(),this.paintSaveLines(),this.isLineStart=!1,this.startFromLeft=!1,this.startFromRight=!1}}clearOnClick(t){t.classList.contains("js-drop-point")||(this.isLineStart=!1,this.clearCanvas(),this.paintSaveLines(),setTimeout(()=>{this.startFromLeft=!1,this.startFromRight=!1,this.isLineStart=!1},0)),"ontouchstart"in window&&t.classList.contains(this.startFrom)&&(this.isLineStart=!1,this.clearCanvas(),this.paintSaveLines(),setTimeout(()=>{this.startFromLeft=!1,this.startFromRight=!1,this.isLineStart=!1},0))}getPositionB(t,e){if(!this.isLineStart)return;this.elemAttention(t),this.position.x2=this.getCenterPosition(t).x,this.position.y2=this.getCenterPosition(t).y;const i={x1:null,y1:null,x2:null,y2:null};if(i.x1=this.position.x1,i.y1=this.position.y1,i.x2=this.position.x2,i.y2=this.position.y2,this.startFromLeft){this.saveLines[this.saveStartNumber]=i;const t=this.saveStartNumber;setTimeout(()=>{this.getUserResult(t,e+"")},0)}this.startFromRight&&(this.saveLines[e]=i,setTimeout(()=>{this.getUserResult(e,this.saveAnswerOrder)},0)),this.clearCanvas(),this.paintSaveLines(),setTimeout(()=>{this.isLineStart=!1,this.startFromLeft=!1,this.startFromRight=!1},0)}paintSaveLines(){const t=this.canvas.nativeElement.getContext("2d");for(const e in this.saveLines)if(Object.prototype.hasOwnProperty.call(this.saveLines,e)){const i=this.saveLines[e];Object.prototype.hasOwnProperty.call(i,"isCorrect")&&(t.strokeStyle=this.saveLines[e].isCorrect?"#92d050":"#FBACAC");const n=i.x1-this.canvas.nativeElement.getBoundingClientRect().left,s=i.y1-this.canvas.nativeElement.getBoundingClientRect().top,o=i.x2-this.canvas.nativeElement.getBoundingClientRect().left,r=i.y2-this.canvas.nativeElement.getBoundingClientRect().top;t.beginPath(),t.moveTo(n,s),t.lineTo(o,r),t.stroke()}}elemAttention(t){t.classList.add("elem-attention"),setTimeout(()=>{t.classList.remove("elem-attention")},300)}getEventPosition(t){let e,i;return"mousemove"===t.type&&(e=t.clientX,i=t.clientY),"touchmove"===t.type&&(e=t.touches[0].clientX,i=t.touches[0].clientY),{clientX:e,clientY:i}}clearCanvas(){this.canvas.nativeElement.getContext("2d").clearRect(0,0,this.wrapper.nativeElement.getBoundingClientRect().width,this.wrapper.nativeElement.getBoundingClientRect().height)}getCenterPosition(t){const e=t.getBoundingClientRect().width/2,i=t.getBoundingClientRect().top;return{x:t.getBoundingClientRect().left+e,y:i+e}}getUserResult(t,e){this.results[t]={Type:"LinkImagesToNumbers",Order:this.Order,Data:{Order:t,Value:e}};for(const i in this.results)Object.prototype.hasOwnProperty.call(this.results,i)&&this.exerciseDataService.subject.next(this.results[i])}ngAfterViewInit(){setTimeout(()=>{this.canvas.nativeElement.width=this.wrapper.nativeElement.getBoundingClientRect().width,this.canvas.nativeElement.height=this.wrapper.nativeElement.getBoundingClientRect().height;const t=this.canvas.nativeElement.getContext("2d");t.strokeStyle="#fccd04",t.lineWidth=this.windowWidth()/100/2},500);const t=document.querySelectorAll(".left__img-value .divider_line-height");Array.from(t).forEach(t=>{t.style.lineHeight="1"})}windowWidth(){const t=window,e=document,i=e.documentElement,n=e.getElementsByTagName("body")[0];return t.innerWidth||i.clientWidth||n.clientWidth}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(r.a),o.Qb(a.a))},t.\u0275cmp=o.Kb({type:t,selectors:[["app-link-images-to-numbers"]],viewQuery:function(t,e){var i;1&t&&(o.Hc(c,!0),o.Hc(l,!0)),2&t&&(o.rc(i=o.fc())&&(e.wrapper=i.first),o.rc(i=o.fc())&&(e.canvas=i.first))},inputs:{isCorrectValues:"isCorrectValues",Order:"Order",list:"list"},features:[o.Ab],decls:1,vars:1,consts:[["class","link-images-wrapper main-f-size d-flex justify-content-between",3,"blockAfterGetResults","mousemove","touchmove","touchend","click",4,"ngIf"],[1,"link-images-wrapper","main-f-size","d-flex","justify-content-between",3,"mousemove","touchmove","touchend","click"],["wrapper",""],[1,"link-images__left-wrapper","d-flex"],[4,"ngFor","ngForOf"],[1,"link-images__right-wrapper","d-flex","flex-column","justify-content-center"],["class","link-images__option bottom_option",4,"ngFor","ngForOf"],[1,"canvas"],["canvas",""],["class","link-image-wrapper d-flex flex-column",4,"ngIf"],[1,"link-image-wrapper","d-flex","flex-column"],["class","link-images__option left_option",4,"ngFor","ngForOf"],[1,"link-images__option","left_option"],[1,"left__img-wrapper"],[1,"left__img",3,"src"],[1,"left__img-value",3,"innerHTML"],[1,"option-point","top_point","js-top-start-point","js-top-drop-point","js-start-point","js-drop-point",3,"click","touchstart"],[1,"link-images__option","bottom_option"],[1,"option-point","bottom_point","js-bottom-start-point","js-bottom-drop-point","js-start-point","js-drop-point",3,"click","touchstart"]],template:function(t,e){1&t&&o.Cc(0,p,8,4,"div",0),2&t&&o.kc("ngIf",e.resultTopValues&&e.resultBottomValues)},directives:[n.j,n.i],styles:["[_nghost-%COMP%]{width:100%;padding-top:1vh;margin:auto;min-height:80%}.blockAfterGetResults[_ngcontent-%COMP%]{pointer-events:none}.link-images-wrapper[_ngcontent-%COMP%]{position:relative;width:80%;height:100%;margin:auto}.canvas[_ngcontent-%COMP%]{position:absolute;z-index:-1;top:0;left:0}.link-images__left-wrapper[_ngcontent-%COMP%]{width:50vw}.link-images__option[_ngcontent-%COMP%]{border-radius:100px;padding:.5vh 2vw;text-align:center;color:#fff;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;position:relative}.left__img-wrapper[_ngcontent-%COMP%]{position:relative;width:85%}.left__img[_ngcontent-%COMP%]{width:100%}.left__img-value[_ngcontent-%COMP%]{padding-top:.5em}.left__img-value_center[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.left_option[_ngcontent-%COMP%]{width:100%;color:#000;padding:0}.left_option[_ngcontent-%COMP%]:last-child{margin-bottom:0;margin-top:auto}.left_option[_ngcontent-%COMP%]:first-child{margin-top:0;margin-bottom:2%}.bottom_option[_ngcontent-%COMP%]{background:#ff712c;width:100%}.bottom_option[_ngcontent-%COMP%]:not(:last-child){margin-bottom:4vh}.link-image-wrapper[_ngcontent-%COMP%]{width:22%}.link-image-wrapper[_ngcontent-%COMP%]:first-child   .left_option[_ngcontent-%COMP%]:nth-child(2){transform:translateX(65%);margin:auto 0}.link-image-wrapper[_ngcontent-%COMP%]:first-child   .left_option[_ngcontent-%COMP%]:last-child{transform:none;margin:auto 0 0}.link-image-wrapper[_ngcontent-%COMP%]:nth-child(2)   .left_option[_ngcontent-%COMP%]{transform:translateX(50%)}.one_item[_ngcontent-%COMP%]{margin-left:20%}.option-point[_ngcontent-%COMP%]{padding:.7vw;border-radius:50%;cursor:pointer;transition:opacity .2s;position:absolute;top:50%;transform:translateY(-50%)}.top_point[_ngcontent-%COMP%]{background:#0b7570;right:-.5em}.bottom_point[_ngcontent-%COMP%]{background:#c74200;left:-3vw}.link-images__right-wrapper[_ngcontent-%COMP%]{margin-left:3vw;width:20%}.elem-attention[_ngcontent-%COMP%]{-webkit-animation:attention .3s;animation:attention .3s}@-webkit-keyframes attention{0%{transform:translateY(-50%) scale(1)}50%{transform:translateY(-50%) scale(1.3)}to{transform:translateY(-50%) scale(1)}}@keyframes attention{0%{transform:translateY(-50%) scale(1)}50%{transform:translateY(-50%) scale(1.3)}to{transform:translateY(-50%) scale(1)}}"]}),t})(),v=(()=>{class t{constructor(t){this.componentFactoryResolver=t}resolveComponent(){return this.componentFactoryResolver.resolveComponentFactory(d)}}return t.\u0275mod=o.Ob({type:t}),t.\u0275inj=o.Nb({factory:function(e){return new(e||t)(o.ac(o.j))},imports:[[n.b,s.n]]}),t})()}}]);