function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{QnFG:function(t,e,n){"use strict";n.r(e),n.d(e,"LinkImagesToNumbersComponent",(function(){return g})),n.d(e,"LinkImagesToNumbersModule",(function(){return f}));var i=n("ofXK"),o=n("3Pt+"),s=n("fXoL"),r=n("XCOF"),a=n("TznM"),c=["wrapper"],l=["canvas"];function u(t,e){if(1&t){var n=s.Xb();s.Wb(0,"div",12),s.Wb(1,"div",13),s.Rb(2,"img",14),s.Rb(3,"div",15),s.Vb(),s.Wb(4,"div",16),s.ec("click",(function(t){s.vc(n);var i=e.$implicit,o=s.hc(4);return[o.getEndPosition(t.target,i.order),o.getStartPosition(t.target,i.order)]}))("touchstart",(function(t){s.vc(n);var i=e.$implicit;return s.hc(4).getStartPosition(t.target,i.order)})),s.Vb(),s.Vb()}if(2&t){var i=e.$implicit,o=s.hc(4);s.Cb(2),s.kc("src",o.resourceLoadsService.getExerciseImage(i.img),s.xc),s.Cb(1),s.Gb("left__img-value_center",o.IsImageTextCentered),s.kc("innerHTML",i.value,s.wc),s.Cb(1),s.Db("data-order",i.order)}}function h(t,e){if(1&t&&(s.Wb(0,"div",10),s.Cc(1,u,5,5,"div",11),s.Vb()),2&t){var n=s.hc().$implicit;s.Cb(1),s.kc("ngForOf",n)}}function m(t,e){if(1&t&&(s.Ub(0),s.Cc(1,h,2,1,"div",9),s.Tb()),2&t){var n=e.$implicit;s.Cb(1),s.kc("ngIf",n.length)}}function p(t,e){if(1&t){var n=s.Xb();s.Wb(0,"div",17),s.Dc(1),s.Wb(2,"div",18),s.ec("click",(function(t){s.vc(n);var i=e.$implicit,o=s.hc(2);return[o.getEndPosition(t.target,i.order),o.getStartPosition(t.target,i.order)]}))("touchstart",(function(t){s.vc(n);var i=e.$implicit;return s.hc(2).getStartPosition(t.target,i.order)})),s.Vb(),s.Vb()}if(2&t){var i=e.$implicit;s.Cb(1),s.Fc(" ",i.value," "),s.Cb(1),s.Db("data-order",i.order)}}function v(t,e){if(1&t){var n=s.Xb();s.Wb(0,"div",1,2),s.ec("mousemove",(function(t){return s.vc(n),s.hc().lineMove(t)}))("touchmove",(function(t){return s.vc(n),s.hc().lineMove(t)}))("touchend",(function(t){return s.vc(n),s.hc().getTouchPositionB(t)}))("click",(function(t){return s.vc(n),s.hc().clearOnClick(t.target)})),s.Wb(2,"div",3),s.Cc(3,m,2,1,"ng-container",4),s.Vb(),s.Wb(4,"div",5),s.Cc(5,p,3,2,"div",6),s.Vb(),s.Rb(6,"canvas",7,8),s.Vb()}if(2&t){var i=s.hc();s.Gb("blockAfterGetResults",i.isCorrectValues),s.Cb(3),s.kc("ngForOf",i.resultTopValues),s.Cb(2),s.kc("ngForOf",i.resultBottomValues)}}var g=function(){var t=function(){function t(e,n){_classCallCheck(this,t),this.exerciseDataService=e,this.resourceLoadsService=n,this.position={x1:null,y1:null,x2:null,y2:null},this.results={},this.saveLines={},this.isLineStart=!1,this.startFrom=""}return _createClass(t,[{key:"ngOnChanges",value:function(){var t=this;if(this.list.sort((function(t,e){return t.Order-e.Order})),this.isCorrectValues){this.saveLines={};var e=document.getElementsByClassName("js-top-start-point"),n=document.getElementsByClassName("js-bottom-start-point");return this.list.forEach((function(i,o){var s,r;t.resultTopValues.forEach((function(o){o.forEach((function(o){t.resultBottomValues.forEach((function(t,a){o.order===i.Order&&t.order===+i.CorrectValue&&(s=e[i.Order-1],r=n[a])}))}))})),t.saveLines[o]={isCorrect:null,x1:null,y1:null,x2:null,y2:null},t.saveLines[o].isCorrect=i.IsCorrect,t.saveLines[o].x1=t.getCenterPosition(s).x,t.saveLines[o].y1=t.getCenterPosition(s).y,t.saveLines[o].x2=t.getCenterPosition(r).x,t.saveLines[o].y2=t.getCenterPosition(r).y})),this.clearCanvas(),void this.paintSaveLines()}var i=[],o=[],s=[];this.list.forEach((function(e){var n={order:e.Order,value:e.Value};"IsImageTextCentered"===e.Metric&&(t.IsImageTextCentered="True"===e.Value),"OptionValue"===e.Metric&&i.push(n),"ImageName"===e.Metric&&o.push(n),"ImageValue"===e.Metric&&s.push(n)}));var r=[];o.forEach((function(t){s.forEach((function(e){t.order===e.order&&r.push({order:t.order,img:t.value,value:e.value})}))}));var a=[[],[]];r.forEach((function(t,e){e<3?a[0].push(t):a[1].push(t)})),this.resultTopValues=a,this.resultBottomValues=i}},{key:"lineMove",value:function(t){if(this.isLineStart){var e=this.wrapper.nativeElement.getBoundingClientRect().left,n=this.wrapper.nativeElement.getBoundingClientRect().top,i=this.getEventPosition(t).clientX-e,o=this.getEventPosition(t).clientY-n,s=this.position.x1-e,r=this.position.y1-n,a=this.canvas.nativeElement.getContext("2d");this.clearCanvas(),a.beginPath(),a.moveTo(s,r),a.lineTo(i,o),a.stroke(),this.paintSaveLines()}}},{key:"getPositionA",value:function(t,e){this.elemAttention(t),this.position.x1=this.getCenterPosition(t).x,this.position.y1=this.getCenterPosition(t).y,this.isLineStart=!0,this.saveStartNumber=e}},{key:"getStartPosition",value:function(t,e){this.elemAttention(t),t.classList.contains("js-top-start-point")&&!this.startFromLeft&&(this.startFrom="js-top-start-point",this.startFromLeft=!0,this.startFromRight=!1,this.getPositionA(t,e)),t.classList.contains("js-bottom-start-point")&&!this.startFromRight&&(this.startFrom="js-bottom-start-point",this.startFromLeft=!1,this.startFromRight=!0,this.getPositionA(t,null)),t.classList.contains("js-bottom-start-point")&&(this.saveAnswerOrder=t.getAttribute("data-order"))}},{key:"getEndPosition",value:function(t,e){var n=this,i=t.classList.contains(this.startFrom);this.isLineStart&&!i&&(this.getPositionB(t,e),setTimeout((function(){n.startFromLeft=!1,n.isLineStart=!1}),0))}},{key:"getTouchPositionB",value:function(t){var e=this;if(this.clearCanvas(),this.paintSaveLines(),this.isLineStart){var n=document.elementFromPoint(t.changedTouches[0].clientX,t.changedTouches[0].clientY);if(n.classList.contains("js-drop-point")&&!n.classList.contains(this.startFrom)){var i=+n.getAttribute("data-order");this.elemAttention(n),this.position.x2=this.getCenterPosition(n).x,this.position.y2=this.getCenterPosition(n).y;var o={x1:null,y1:null,x2:null,y2:null};if(o.x1=this.position.x1,o.y1=this.position.y1,o.x2=this.position.x2,o.y2=this.position.y2,this.startFromLeft){this.saveLines[this.saveStartNumber]=o;var s=this.saveStartNumber;setTimeout((function(){e.getUserResult(s,i+"")}),0)}this.startFromRight&&(this.saveLines[i]=o,setTimeout((function(){e.getUserResult(i,e.saveAnswerOrder)}),0)),this.clearCanvas(),this.paintSaveLines(),this.isLineStart=!1,this.startFromLeft=!1,this.startFromRight=!1}}}},{key:"clearOnClick",value:function(t){var e=this;t.classList.contains("js-drop-point")||(this.isLineStart=!1,this.clearCanvas(),this.paintSaveLines(),setTimeout((function(){e.startFromLeft=!1,e.startFromRight=!1,e.isLineStart=!1}),0)),"ontouchstart"in window&&t.classList.contains(this.startFrom)&&(this.isLineStart=!1,this.clearCanvas(),this.paintSaveLines(),setTimeout((function(){e.startFromLeft=!1,e.startFromRight=!1,e.isLineStart=!1}),0))}},{key:"getPositionB",value:function(t,e){var n=this;if(this.isLineStart){this.elemAttention(t),this.position.x2=this.getCenterPosition(t).x,this.position.y2=this.getCenterPosition(t).y;var i={x1:null,y1:null,x2:null,y2:null};if(i.x1=this.position.x1,i.y1=this.position.y1,i.x2=this.position.x2,i.y2=this.position.y2,this.startFromLeft){this.saveLines[this.saveStartNumber]=i;var o=this.saveStartNumber;setTimeout((function(){n.getUserResult(o,e+"")}),0)}this.startFromRight&&(this.saveLines[e]=i,setTimeout((function(){n.getUserResult(e,n.saveAnswerOrder)}),0)),this.clearCanvas(),this.paintSaveLines(),setTimeout((function(){n.isLineStart=!1,n.startFromLeft=!1,n.startFromRight=!1}),0)}}},{key:"paintSaveLines",value:function(){var t=this.canvas.nativeElement.getContext("2d");for(var e in this.saveLines)if(Object.prototype.hasOwnProperty.call(this.saveLines,e)){var n=this.saveLines[e];Object.prototype.hasOwnProperty.call(n,"isCorrect")&&(t.strokeStyle=this.saveLines[e].isCorrect?"#92d050":"#FBACAC");var i=n.x1-this.canvas.nativeElement.getBoundingClientRect().left,o=n.y1-this.canvas.nativeElement.getBoundingClientRect().top,s=n.x2-this.canvas.nativeElement.getBoundingClientRect().left,r=n.y2-this.canvas.nativeElement.getBoundingClientRect().top;t.beginPath(),t.moveTo(i,o),t.lineTo(s,r),t.stroke()}}},{key:"elemAttention",value:function(t){t.classList.add("elem-attention"),setTimeout((function(){t.classList.remove("elem-attention")}),300)}},{key:"getEventPosition",value:function(t){var e,n;return"mousemove"===t.type&&(e=t.clientX,n=t.clientY),"touchmove"===t.type&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{clientX:e,clientY:n}}},{key:"clearCanvas",value:function(){this.canvas.nativeElement.getContext("2d").clearRect(0,0,this.wrapper.nativeElement.getBoundingClientRect().width,this.wrapper.nativeElement.getBoundingClientRect().height)}},{key:"getCenterPosition",value:function(t){var e=t.getBoundingClientRect().width/2,n=t.getBoundingClientRect().top;return{x:t.getBoundingClientRect().left+e,y:n+e}}},{key:"getUserResult",value:function(t,e){for(var n in this.results[t]={Type:"LinkImagesToNumbers",Order:this.Order,Data:{Order:t,Value:e}},this.results)Object.prototype.hasOwnProperty.call(this.results,n)&&this.exerciseDataService.subject.next(this.results[n])}},{key:"ngAfterViewInit",value:function(){var t=this;setTimeout((function(){t.canvas.nativeElement.width=t.wrapper.nativeElement.getBoundingClientRect().width,t.canvas.nativeElement.height=t.wrapper.nativeElement.getBoundingClientRect().height;var e=t.canvas.nativeElement.getContext("2d");e.strokeStyle="#fccd04",e.lineWidth=t.windowWidth()/100/2}),500);var e=document.querySelectorAll(".left__img-value .divider_line-height");Array.from(e).forEach((function(t){t.style.lineHeight="1"}))}},{key:"windowWidth",value:function(){var t=window,e=document,n=e.documentElement,i=e.getElementsByTagName("body")[0];return t.innerWidth||n.clientWidth||i.clientWidth}}]),t}();return t.\u0275fac=function(e){return new(e||t)(s.Qb(r.a),s.Qb(a.a))},t.\u0275cmp=s.Kb({type:t,selectors:[["app-link-images-to-numbers"]],viewQuery:function(t,e){var n;1&t&&(s.Hc(c,!0),s.Hc(l,!0)),2&t&&(s.rc(n=s.fc())&&(e.wrapper=n.first),s.rc(n=s.fc())&&(e.canvas=n.first))},inputs:{isCorrectValues:"isCorrectValues",Order:"Order",list:"list"},features:[s.Ab],decls:1,vars:1,consts:[["class","link-images-wrapper main-f-size d-flex justify-content-between",3,"blockAfterGetResults","mousemove","touchmove","touchend","click",4,"ngIf"],[1,"link-images-wrapper","main-f-size","d-flex","justify-content-between",3,"mousemove","touchmove","touchend","click"],["wrapper",""],[1,"link-images__left-wrapper","d-flex"],[4,"ngFor","ngForOf"],[1,"link-images__right-wrapper","d-flex","flex-column","justify-content-center"],["class","link-images__option bottom_option",4,"ngFor","ngForOf"],[1,"canvas"],["canvas",""],["class","link-image-wrapper d-flex flex-column",4,"ngIf"],[1,"link-image-wrapper","d-flex","flex-column"],["class","link-images__option left_option",4,"ngFor","ngForOf"],[1,"link-images__option","left_option"],[1,"left__img-wrapper"],[1,"left__img",3,"src"],[1,"left__img-value",3,"innerHTML"],[1,"option-point","top_point","js-top-start-point","js-top-drop-point","js-start-point","js-drop-point",3,"click","touchstart"],[1,"link-images__option","bottom_option"],[1,"option-point","bottom_point","js-bottom-start-point","js-bottom-drop-point","js-start-point","js-drop-point",3,"click","touchstart"]],template:function(t,e){1&t&&s.Cc(0,v,8,4,"div",0),2&t&&s.kc("ngIf",e.resultTopValues&&e.resultBottomValues)},directives:[i.j,i.i],styles:["[_nghost-%COMP%]{width:100%;padding-top:1vh;margin:auto;min-height:80%}.blockAfterGetResults[_ngcontent-%COMP%]{pointer-events:none}.link-images-wrapper[_ngcontent-%COMP%]{position:relative;width:80%;height:100%;margin:auto}.canvas[_ngcontent-%COMP%]{position:absolute;z-index:-1;top:0;left:0}.link-images__left-wrapper[_ngcontent-%COMP%]{width:50vw}.link-images__option[_ngcontent-%COMP%]{border-radius:100px;padding:.5vh 2vw;text-align:center;color:#fff;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;position:relative}.left__img-wrapper[_ngcontent-%COMP%]{position:relative;width:85%}.left__img[_ngcontent-%COMP%]{width:100%}.left__img-value[_ngcontent-%COMP%]{padding-top:.5em}.left__img-value_center[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.left_option[_ngcontent-%COMP%]{width:100%;color:#000;padding:0}.left_option[_ngcontent-%COMP%]:last-child{margin-bottom:0;margin-top:auto}.left_option[_ngcontent-%COMP%]:first-child{margin-top:0;margin-bottom:2%}.bottom_option[_ngcontent-%COMP%]{background:#ff712c;width:100%}.bottom_option[_ngcontent-%COMP%]:not(:last-child){margin-bottom:4vh}.link-image-wrapper[_ngcontent-%COMP%]{width:22%}.link-image-wrapper[_ngcontent-%COMP%]:first-child   .left_option[_ngcontent-%COMP%]:nth-child(2){transform:translateX(65%);margin:auto 0}.link-image-wrapper[_ngcontent-%COMP%]:first-child   .left_option[_ngcontent-%COMP%]:last-child{transform:none;margin:auto 0 0}.link-image-wrapper[_ngcontent-%COMP%]:nth-child(2)   .left_option[_ngcontent-%COMP%]{transform:translateX(50%)}.one_item[_ngcontent-%COMP%]{margin-left:20%}.option-point[_ngcontent-%COMP%]{padding:.7vw;border-radius:50%;cursor:pointer;transition:opacity .2s;position:absolute;top:50%;transform:translateY(-50%)}.top_point[_ngcontent-%COMP%]{background:#0b7570;right:-.5em}.bottom_point[_ngcontent-%COMP%]{background:#c74200;left:-3vw}.link-images__right-wrapper[_ngcontent-%COMP%]{margin-left:3vw;width:20%}.elem-attention[_ngcontent-%COMP%]{-webkit-animation:attention .3s;animation:attention .3s}@-webkit-keyframes attention{0%{transform:translateY(-50%) scale(1)}50%{transform:translateY(-50%) scale(1.3)}to{transform:translateY(-50%) scale(1)}}@keyframes attention{0%{transform:translateY(-50%) scale(1)}50%{transform:translateY(-50%) scale(1.3)}to{transform:translateY(-50%) scale(1)}}"]}),t}(),f=function(){var t=function(){function t(e){_classCallCheck(this,t),this.componentFactoryResolver=e}return _createClass(t,[{key:"resolveComponent",value:function(){return this.componentFactoryResolver.resolveComponentFactory(g)}}]),t}();return t.\u0275mod=s.Ob({type:t}),t.\u0275inj=s.Nb({factory:function(e){return new(e||t)(s.ac(s.j))},imports:[[i.b,o.n]]}),t}()}}]);